@prefix rdf: 	  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> . 
@prefix rdfs: 	  <http://www.w3.org/2000/01/rdf-schema#> . 
@prefix owl: 	  <http://www.w3.org/2002/07/owl#> . 
@prefix xsd: 	  <http://www.w3.org/2001/XMLSchema#> . 

@prefix ottr: 	  <http://ns.ottr.xyz/0.4/> . 
@prefix ax: 	  <http://tpl.ottr.xyz/owl/axiom/0.1/> . 
@prefix rstr: 	  <http://tpl.ottr.xyz/owl/restriction/0.1/> .

@prefix :  <http://w3id.org/sepses/vocab/log/core#> .
@prefix parser:  <http://w3id.org/sepses/vocab/log/parser#> .
@prefix instance:  <http://w3id.org/sepses/id/> .

@prefix sepses: 	  <http://sepses.com/ns#> .  

sepses:LogLine[?id, xsd:datetime ?timeStamp, xsd:string ?message, xsd:string ?templateHash, List<xsd:string> ?parameters] :: {
      ottr:Triple(?id, rdf:type, :LogEntry),
      ottr:Triple(?id, :timestamp, ?timeStamp),
      ottr:Triple(?id, parser:templateId, ?templateHash),
      ottr:Triple(?id, :logMessage, ?message),
      cross | ottr:Triple(?id, parser:connected, ++?parameters)
    } .

sepses:InvalidUser[?id, xsd:datetime ?timeStamp, xsd:string ?message, xsd:string ?templateHash, xsd:string ?user, xsd:string ?ip] :: {
         ottr:Triple(?id, rdf:type, :InvalidUserLogEntry),
         ottr:Triple(?id, :timestamp, ?timeStamp),
         ottr:Triple(?id, parser:templateId, ?templateHash),
         ottr:Triple(?id, :logMessage, ?message),
         sepses:User(?id, ?user),
         ottr:Triple(?id, parser:connectedHost, ?ip)
       } .

sepses:User[ottr:IRI ?id, xsd:string ?user] :: {
    ottr:Triple(?id, parser:connectedUser, ?user)
} .
